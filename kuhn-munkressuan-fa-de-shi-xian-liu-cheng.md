\(1\) 初始化各个顶点的顶标值；

\(2\) 找出符合“A\[i\]+B\[j\] = weight\[i,j\]”条件的边构成相等子图，使用匈牙利算法寻找相等子图的完美匹配；

\(3\) 如果找到相等子图的完美匹配，则算法结束，否则调整相关顶点的顶标值；

\(4\) 重复步骤\(2\)\(3\)，直到找到完美匹配为止。

第\(1\)步初始化顶点顶标值可采用式\(7-1\)计算：

![](/assets/km.png)

因为A\[i\]总是取与之相邻的边中最大的权值作为初始值，因此初始阶段能保证满足“A\[i\]+B\[j\] ≥ weight\[i,j\]”条件。如果在第\(2\)步的相等子图中没有找到完美匹配，说明相等子图中某个顶点出发的增广路径不能覆盖所有顶点。此时需要调整各个顶点的顶标值，然后重新在相等子图中寻找完美匹配。调整顶标的目的是为了扩大相等子图，使得更多的边进入相等子图，并最终能够找到一个完美匹配。设当前增广路径上所有属于X集合的顶点构成一个子集S，所有属于Y集合的顶点构成一个子集T，dx为顶标调整的变化量，则dx可采用式\(7-2\)给出的方法计算：

![](/assets/km2.png)

